import helper_sql_server
import os
from stat_plan import Stat_plan
from stat_sql import Stat_sql
from datetime import datetime
import time
import helper_file
import helper_regex
import helper_mysql
import config
import common_shabik_360

helper_mysql.quick_insert=True

groups={
    #'2012_02_13_05:00~2012_02_14_05:00':set([966500000499,966500000651,966500001229,966500003350,966500003361,966500003830,966500004493,966500004530,966500005008,966500006461,966500006684,966500006938,966500007236,966500007348,966500007454,966500007779,966500009074,966500009383,966500009748,966500009870,966500010119,966500010224,966500010414,966500010518,966500012485,966500014677,966500014992,966500015445,966500016702,966500017416,966500017704,966500017951,966500018168,966500018187,966500018353,966500018752,966500019163,966500019709,966500020158,966500020503,966500020692,966500020853,966500021979,966500022011,966500023000,966500023132,966500023241,966500024314,966500024922,966500025031,966500027106,966500027180,966500029897,966500029928,966500030088,966500030508,966500032133,966500032490,966500032613,966500032724,966500033052,966500034694,966500034858,966500036036,966500036211,966500036273,966500036673,966500036735,966500037009,966500038966,966500039405,966500040969,966500040972,966500041122,966500041410,966500041582,966500041985,966500042224,966500042229,966500042407,966500042456,966500042853,966500043005,966500043041,966500043457,966500044265,966500044269,966500044975,966500045992,966500047098,966500047238,966500047457,966500047909,966500048032,966500048151,966500048600,966500049102,966500049729,966500050277,966500050749,966500050934,966500051597,966500051767,966500053188,966500053461,966500054123,966500054614,966500054636,966500054882,966500054911,966500055055,966500055195,966500056138,966500056336,966500056731,966500057441,966500057597,966500057741,966500059883,966500059921,966500060600,966500060856,966500062606,966500063071,966500063172,966500063583,966500064940,966500065399,966500066076,966500066091,966500066505,966500068629,966500070078,966500070089,966500070564,966500070596,966500072878,966500072887,966500073564,966500074937,966500075085,966500075835,966500076045,966500076795,966500077096,966500077768,966500078053,966500078340,966500079741,966500080167,966500082898,966500083558,966500083807,966500083849,966500084326,966500084882,966500085159,966500085623,966500087902,966500088030,966500088514,966500089060,966500089724,966500089740,966500089783,966500090126,966500091029,966500091257,966500091542,966500091963,966500092436,966500093122,966500093134,966500093336,966500093391,966500094866,966500095495,966500096306,966500096311,966500096427,966500096854,966500097299,966500097719,966500097967,966500098176,966500099138,966500099155,966500099783,966500100536,966500100660,966500100810,966500100867,966500101190,966500101772,966500102252,966500104190,966500104374,966500104651,966500104736,966500105401,966500105715,966500107325,966500107419,966500107769,966500108403,966500109009,966500110490,966500111380,966500111837,966500111862,966500113303,966500113986,966500114773,966500115274,966500115681,966500116101,966500116177,966500116651,966500120090,966500121296,966500122054,966500122257,966500122918,966500126881,966500128098,966500128208,966500128438,966500130642,966500131448,966500132019,966500132194,966500133747,966500133935,966500135456,966500138441,966500139559,966500140749,966500140872,966500142476,966500142684,966500142697,966500142733,966500144261,966500144636,966500146163,966500147553,966500147822,966500148080,966500149690,966500151023,966500151885,966500153977,966500155141,966500155483,966500155577,966500157730,966500158756,966500158860,966500161607,966500163399,966500165003,966500165643,966500166869,966500167656,966500168341,966500168674,966500169980,966500170555,966500170689,966500171222,966500173205,966500174418,966500174566,966500175233,966500175499,966500175770,966500176083,966500180140,966500180540,966500180920,966500181108,966500181981,966500182208,966500182822,966500184177,966500184433,966500184450,966500184489,966500184499,966500185363,966500185996,966500186344,966500188762,966500188836,966500189075,966500190200,966500190296,966500190327,966500192394,966500193453,966500196995,966500199200,966500200449,966500200479,966500201110,966500210099,966500211100,966500216196,966500218471,966500219067,966500219900,966500220221,966500222104,966500222263,966500223455,966500226202,966500235656,966500235665,966500236444,966500246661,966500247924,966500251118,966500251540,966500252057,966500252234,966500253325,966500257222,966500260075,966500262764,966500272673,966500275511,966500290726,966500292626,966500300009,966500300404,966500303605,966500305551,966500305634,966500309082,966500316808,966500319222,966500322225,966500328733,966500330909,966500330990,966500333155,966500334131,966500336686,966500336988,966500337955,966500338886,966500341007,966500344342,966500345004,966500345699,966500353324,966500355565,966500363323,966500365214,966500367020,966500370100,966500379115,966500383757,966500384185,966500390505,966500390914,966500393999,966500396829,966500397907,966500400621,966500400782,966500401666,966500401799,966500403666,966500404646,966500408506,966500415403,966500418195,966500422256,966500425511,966500428822,966500439362,966500440450,966500444033,966500444778,966500444944,966500445608,966500450330,966500453705,966500453939,966500457268,966500458000,966500462500,966500480066,966500481153,966500484581,966500485967,966500488887,966500496663,966500500282,966500500479,966500500756,966500501178,966500501189,966500502556,966500503091,966500505530,966500505717,966500506868,966500509059,966500509400,966500509518,966500509630,966500509635,966500509880,966500509912,966500511444,966500513864,966500513997,966500515080,966500515290,966500515507,966500516944,966500517222,966500518886,966500519180,966500519590,966500519948,966500520345,966500520967,966500521356,966500523601,966500524693,966500529508,966500531142,966500531528,966500531689,966500532627,966500533330,966500539055,966500540377,966500542516,966500544331,966500547052,966500548062,966500548707,966500549558,966500550115,966500550695,966500551997,966500552000,966500553622,966500555098,966500555147,966500555374,966500555471,966500557781,966500558259,966500558369,966500558483,966500559019,966500560905,966500561164,966500562243,966500562315,966500564378,966500566717,966500567030,966500571058,966500571311,966500571898,966500572671,966500572738,966500573538,966500574203,966500577160,966500577796,966500577859,966500578816,966500578892,966500579802,966500579997,966500580561,966500580568,966500584892,966500585157,966500585279,966500585631,966500585804,966500586142,966500586521,966500587240,966500587251,966500587454,966500587948,966500588029,966500588322,966500588559,966500589888,966500590342,966500590468,966500590664,966500591885,966500592550,966500594496,966500595067,966500595567,966500595931,966500595974,966500597195,966500597438,966500599903,966500600103,966500600155,966500600173,966500600193,966500600977,966500602190,966500602333,966500602521,966500604515,966500605605,966500605974,966500606028,966500606054,966500606736,966500608554,966500609083,966500611001,966500611204,966500611493,966500611700,966500612185,966500612890,966500613993,966500615813,966500616443,966500617170,966500618469,966500618855,966500619995,966500622322,966500622422,966500622433,966500623852,966500625198,966500626644,966500627544,966500627656,966500628527,966500628869,966500629318,966500630418,966500633663,966500636161,966500637998,966500641388,966500641544,966500642233,966500642514,966500642810,966500642844,966500646474,966500647304,966500647702,966500649431,966500651110,966500651417,966500652373,966500652689,966500652948,966500654832,966500656452,966500657500,966500658868,966500660749,966500660977,966500661103,966500661514,966500663366,966500664052,966500665474,966500665564,966500665576,966500666482,966500666508,966500666681,966500666724,966500666846,966500666906,966500670012,966500670414,966500670947,966500673755,966500677872,966500679966,966500682038,966500682998,966500683056,966500683338,966500683736,966500683846,966500685025,966500685174,966500686385,966500688762,966500689268,966500690097,966500692436,966500693876,966500694586,966500695950,966500700038,966500700354,966500700709,966500706345,966500709955,966500720004,966500733609,966500735577,966500737788,966500740076,966500752451,966500765148,966500772020,966500777121,966500777783,966500781148,966500782872,966500788890,966500791355,966500795595,966500796969,966500800090,966500800290,966500800535,966500801854,966500804396,966500804774,966500806066,966500808092,966500808155,966500809793,966500813570,966500814417,966500815006,966500816150,966500817181,966500817944,966500821239,966500823030,966500824872,966500826589,966500826606,966500828194,966500828278,966500828387,966500829630,966500830375,966500830403,966500831555,966500832344,966500838335,966500840412,966500841319,966500843600,966500844336,966500845007,966500845771,966500846118,966500847421,966500848395,966500849695,966500850567,966500851800,966500856455,966500857418,966500859573,966500860683,966500862861,966500867041,966500868811,966500869231,966500872142,966500872723,966500872875,966500873140,966500873943,966500874558,966500877492,966500879331,966500879687,966500880067,966500880130,966500880556,966500882360,966500884954,966500885210,966500885724,966500887891,966500888081,966500888106,966500888164,966500888357,966500888368,966500888665,966500888784,966500889945,966500890950,966500891758,966500891887,966500893285,966500893551,966500894565,966500894906,966500895129,966500895218,966500896659,966500898686,966500899324,966500900152,966500900236,966500900632,966500904888,966500905557,966500910008,966500910844,966500912320,966500926328,966500945060,966500947124,966500949501,966500949966,966500955888,966500957895,966500961559,966500964000,966500968886,966500969607,966500977700,966500978688,966500980916,966500986277,966500988868,966500992111,966500992223,966500995799,966500997717,966500998877,966500998933,966500999927,966501000132,966501000810,966501000899,966501006637,966501010522,966501012100,966501015501,966501019696,966501020113,966501021066,966501027618,966501029999,966501047653,966501053973,966501055370,966501065752,966501066908,966501068933,966501075556,966501079555,966501085335,966501100250,966501100535,966501101041,966501101102,966501103367,966501111813,966501111982,966501114004,966501114513,966501114825,966501115178,966501117511,966501118185,966501120461,966501127811,966501133103,966501133644,966501133732,966501134007,966501155115,966501155558,966501157888,966501162200,966501166044,966501166199,966501173395,966501177110,966501181545,966501199225,966501200120,966501203307,966501212690,966501217555,966501224227,966501231010,966501231444,966501232999,966501233022,966501238308,966501258588,966501269644,966501279776,966501315644,966501321114,966501330296,966501332113,966501334257,966501346102,966501359755,966501367458,966501371876,966501373383,966501393269,966501399998,966501404205,966501427401,966501440441,966501444108,966501444365,966501449339,966501454138,966501467920,966501468000,966501472170,966501474748,966501475109,966501476232,966501482566,966501499333,966501502766,966501516972,966501524373,966501525795,966501531630,966501533990,966501540404,966501555501,966501556115,966501556663,966501560015,966501577999,966501585677,966501588833,966501611193,966501632461,966501639205,966501655068,966501668934,966501668963,966501683389,966501683778,966501683861,966501684434,966501684535,966501684857,966501685794,966501690693,966501690749,966501691530,966501700667,966501702161,966501702492,966501703019,966501710162,966501710860,966501712682,966501714124,966501717124,966501717161,966501727212,966501730828,966501731167,966501732106,966501733339,966501733902,966501734174,966501734192,966501734329,966501735146,966501736995,966501738210,966501739185,966501739868,966501742589,966501742642,966501743795,966501743977,966501744589,966501755755,966501761930,966501762838,966501771133,966501771317,966501771537,966501772424,966501772433,966501778835,966501790555,966501792060,966501794205,966501797015,966501804028,966501812514,966501813858,966501815253,966501833555,966501853339,966501860000,966501864964,966501870830,966501879477,966501884404,966501888808,966501888815,966501894924,966501897202,966501900578,966501901476,966501902718,966501902941,966501903958,966501904899,966501905618,966501905833,966501906319,966501908774,966501940715,966501944442,966501950263,966501965853,966501968265,966501981308,966501981429,966501992841,966501996854,966502000074,966502000842,966502000933,966502003952,966502005330,966502006226,966502021668,966502030224,966502040290,966502044012,966502044442,966502055515,966502059110,966502077780,966502103609,966502111654,966502112291,966502120011,966502124667,966502124828,966502125822,966502126647,966502142894,966502149034,966502150467,966502152728,966502154503,966502167444,966502171413,966502188879,966502193619,966502194593,966502200330,966502200822,966502209660,966502211145,966502220230,966502220505,966502220721,966502220900,966502221445,966502222702,966502223173,966502224033,966502226788,966502229797,966502232211,966502233155,966502237000,966502238753,966502239233,966502242157,966502254987,966502255554,966502256664,966502259347,966502260006,966502271711,966502276222,966502280876,966502286944,966502292210,966502293339,966502299177,966502300007,966502300895,966502303122,966502303758,966502304447,966502323822,966502324380,966502329100,966502332229,966502341117,966502342035,966502343462,966502357204,966502362285,966502362878,966502375558,966502377444,966502380918,966502385006,966502387331,966502394377,966502400519,966502407097,966502411700,966502423277,966502444476,966502447000,966502454440,966502458536,966502494252,966502500778,966502506284,966502515282,966502525267,966502525595,966502526276,966502527777,966502531937,966502542534,966502544357,966502544430,966502548488,966502549185,966502555025,966502555080,966502555516,966502566611,966502583318,966502589103,966502601151,966502601282,966502616080,966502621305,966502622764,966502623331,966502627975,966502634375,966502659095,966502662492,966502666628,966502668476,966502678147,966502697039,966502698469,966502698943,966502700707,966502707022,966502708000,966502709251,966502710624,966502717255,966502723793,966502740076,966502744466,966502746112,966502760763,966502783338,966502787779,966502797287,966502797990,966502799946,966502802828,966502807396,966502810857,966502820430,966502824273,966502824982,966502826478,966502830283,966502831344,966502837855,966502840933,966502848462,966502855005,966502870846,966502876333,966502877776,966502878586,966502884488,966502890798,966502891404,966502901982,966502914391,966502915733,966502916159,966502921000,966502936628,966502954384,966502955595,966502989521,966502990827,966502991133,966502991259,966502992207,966502992555,966502993822,966502994045,966502996569,966502997112,966502997369,966502998208,966502999080,966502999528,966503000245,966503000480,966503000815,966503001145,966503001332,966503003310,966503003331,966503004581,966503004899,966503005047,966503005456,966503005954,966503006464,966503006623,966503007276,966503007748,966503007756,966503008114,966503010035,966503010804,966503011931,966503012111,966503012871,966503013310,966503013313,966503013877,966503015359,966503016838,966503017889,966503018266,966503020810,966503022201,966503022865,966503023370,966503025897,966503026784,966503026857,966503027084,966503027555,966503029167,966503030867,966503032400,966503032531,966503034004,966503035053,966503035295,966503035442,966503036444,966503036557,966503036969,966503037409,966503039899,966503040235,966503041152,966503042183,966503042425,966503042649,966503043474,966503043492,966503043906,966503044878,966503044911,966503045367,966503046664,966503046779,966503047958,966503047970,966503049099,966503054928,966503055980,966503056333,966503056429,966503057053,966503057662,966503058566,966503058848,966503059041,966503060377,966503060804,966503060828,966503062001,966503063310,966503063861,966503065557,966503066508,966503066749,966503066761,966503067224,966503069555,966503069989,966503070047,966503070093,966503071738,966503072645,966503072902,966503073014,966503075260,966503077423,966503077798,966503078117,966503078810,966503079981,966503080177,966503081409,966503081671,966503081900,966503084695,966503085872,966503085919,966503087815,966503087941,966503088022,966503088452,966503088502,966503089312,966503089552,966503090288,966503090575,966503090576,966503090885,966503091117,966503092049,966503093086,966503098123,966503099858,966503099935,966503105699,966503105955,966503106102,966503106998,966503107820,966503110368,966503110414,966503111072,966503111339,966503111532,966503111595,966503111931,966503112274,966503113231,966503113273,966503113838,966503114174,966503115011,966503115639,966503117099,966503118016,966503118771,966503119071,966503119972,966503123422,966503123451,966503123977,966503124631,966503125802,966503126616,966503129129,966503129417,966503130876,966503133044,966503134989,966503137439,966503137707,966503137760,966503138132,966503140881,966503141595,966503141661,966503141749,966503142201,966503143874,966503145737,966503145861,966503146245,966503147300,966503147983,966503148809,966503149783,966503149871,966503150662,966503151490,966503151918,966503153305,966503154358,966503156035,966503156493,966503156876,966503157290,966503158528,966503159196,966503159339,966503159532,966503159555,966503159562,966503160561,966503160697,966503161897,966503162262,966503162627,966503162800,966503163409,966503163709,966503163881,966503164435,966503165513,966503166257,966503167727,966503174956,966503176090,966503177544,966503178740,966503181611,966503182305,966503183396,966503184387,966503184501,966503184673,966503185052,966503185189,966503186506,966503187459,966503188486,966503189493,966503191870,966503193319,966503195463,966503197489,966503198174,966503199422,966503199496,966503200819,966503201052,966503201472,966503202189,966503203560,966503204905,966503205043,966503208125,966503208685,966503209697,966503210709,966503211131,966503211614,966503213214,966503213543,966503215143,966503215192,966503216377,966503216418,966503216686,966503217452,966503218652,966503220127,966503220771,966503221604,966503222285,966503222374,966503222784,966503223032,966503224621,966503225453,966503227781,966503227962,966503229483,966503229580,966503230010,966503231998,966503233660,966503234687,966503235689,966503236368,966503236498,966503239792,966503241432,966503242072,966503243475,966503243764,966503244101,966503246523,966503246829,966503247046,966503248702,966503249639,966503249905,966503250805,966503250985,966503251000,966503251138,966503252784,966503253177,966503255653,966503256791,966503256792,966503258130,966503258449,966503261004,966503261046,966503261185,966503261739,966503261889,966503262627,966503263380,966503264203,966503264533,966503265975,966503266342,966503267193,966503269180,966503269204,966503269666,966503272281,966503274361,966503274413,966503274783,966503277360,966503277413,966503278303,966503278731,966503281216,966503282107,966503282833,966503282992,966503283293,966503283956,966503286071,966503287185,966503288082,966503289335,966503289844,966503291455,966503292631,966503294859,966503296314,966503299158,966503299555,966503300132,966503300227,966503300590,966503300610,966503300740,966503301310,966503301830,966503305782,966503308194,966503309319,966503309362,966503309896,966503310359,966503310666,966503312160,966503313824,966503315154,966503319380,966503321010,966503321014,966503324269,966503324442,966503324482,966503325240,966503325409,966503326073,966503326308,966503328169,966503330684,966503331851,966503332198,966503332455,966503332914,966503333043,966503333203,966503333824,966503333843,966503333937,966503335130,966503335435,966503336879,966503337301,966503338940,966503339381,966503339590,966503339634,966503339678,966503343364,966503343997,966503344456,966503345377,966503345525,966503345769,966503345815,966503346805,966503348356,966503348733,966503350136,966503350221,966503350561,966503352519,966503353248,966503353876,966503355011,966503355433,966503355470,966503355945,966503359128,966503362222,966503363124,966503365143,966503366162,966503366350,966503367680,966503369808,966503369853,966503369967,966503375591,966503375985,966503376733,966503377159,966503381377,966503381706,966503382397,966503383316,966503383736,966503384474,966503384949,966503385813,966503385930,966503386993,966503387967,966503389396,966503390264,966503392088,966503392679,966503392798,966503392990,966503394247,966503394999,966503396968,966503397606,966503398279,966503398981,966503399436,966503401538,966503402178,966503402416,966503403176,966503403248,966503403857,966503404041,966503404275,966503404796,966503405606,966503406309,966503406357,966503407987,966503408199,966503409311,966503409589,966503410752,966503413605,966503414734,966503415039,966503418680,966503419221,966503419619,966503419905,966503420266,966503420907,966503421289,966503421351,966503421705,966503422039,966503422549,966503422702,966503423154,966503426284,966503426297,966503426351,966503427238,966503428872,966503430221,966503430966,966503431217,966503431947,966503432269,966503432644,966503432681,966503433612,966503433835,966503434203,966503434367,966503434790,966503436813,966503437494,966503437764,966503438699,966503440093,966503440583,966503441625,966503442145,966503444506,966503445308,966503445351,966503446649,966503447041,966503448715,966503449682,966503449853,966503451115,966503452087,966503454349,966503454886,966503455287,966503455604,966503456663,966503456673,966503456925,966503458261,966503459224,966503459765,966503460200,966503460401,966503460809,966503462324,966503462704,966503463497,966503463745,966503464846,966503465423,966503465484,966503465603,966503467148,966503467200,966503467696,966503469151,966503469427,966503470244,966503470285,966503471076,966503472679,966503473153,966503475184,966503475308,966503475663,966503476436,966503476511,966503476664,966503479636,966503479686,966503480188,966503481943,966503482374,966503482534,966503482998,966503484328,966503485655,966503486348,966503486987,966503487035,966503488412,966503489239,966503489492,966503489598,966503489783,966503490000,966503492346,966503494210,966503494810,966503495199,966503495775,966503496442,966503498624,966503498730,966503499014,966503499088,966503499530,966503499734,966503500414,966503502960,966503503824,966503504609,966503505248,966503506625,966503508889,966503509223,966503512493,966503513526,966503513535,966503513600,966503513741,966503514583,966503514590,966503515313,966503516054,966503516299,966503516927,966503517369,966503518993,966503519013,966503519386,966503519530,966503521840,966503523350,966503523732,966503524596,966503525157,966503525318,966503525729,966503527077,966503529821,966503531783,966503532330,966503532597,966503533058,966503533076,966503533307,966503533655,966503533684,966503533887,966503534334,966503537128,966503537353,966503538600,966503540413,966503543343,966503543483,966503547284,966503547677,966503548028,966503554947,966503555159,966503555486,966503555561,966503556356,966503556510,966503557615,966503558554,966503559645,966503560265,966503562557,966503562613,966503562984,966503568443,966503568876,966503570229,966503570580,966503572880,966503573451,966503573512,966503574931,966503575724,966503576498,966503579982,966503580072,966503580969,966503581169,966503581487,966503582230,966503582410,966503587629,966503587810,966503588093,966503589171,966503590355,966503590401,966503593365,966503594361,966503594423,966503594796,966503601188,966503602314,966503602677,966503603070,966503603182,966503603327,966503603649,966503603677,966503604682,966503605994,966503606219,966503608474,966503608486,966503609307,966503609941,966503610280,966503610887,966503611123,966503611155,966503611716,966503616627,966503617776,966503619573,966503620085,966503620797,966503621719,966503622790,966503622810,966503623813,966503624765,966503625356,966503625686,966503625810,966503626709,966503626920,966503627249,966503627534,966503627709,966503628188,966503629097,966503629907,966503630399,966503630426,966503635979,966503636008,966503636147,966503638791,966503642001,966503642683,966503643699,966503644511,966503645568,966503645578,966503645839,966503646185,966503648096,966503649433,966503651476,966503651851,966503654457,966503655389,966503656006,966503656814,966503657374,966503657459,966503658145,966503658171,966503658703,966503659037,966503659403,966503660651,966503660664,966503660703,966503661110,966503661140,966503661254,966503661668,966503661732,966503661742,966503663065,966503663199,966503663660,966503664484,966503665121,966503665197,966503666142,966503668801,966503670245,966503671933,966503672621,966503674259,966503675120,966503676404,966503676487,966503676857,966503677776,966503678196,966503679046,966503679791,966503680040,966503680299,966503681001,966503681115,966503682334,966503682919,966503683152,966503683330,966503685277,966503685910,966503686240,966503686752,966503686823,966503687622,966503689278,966503689543,966503689878,966503689908,966503691346,966503694687,966503696069,966503696286,966503697386,966503698065,966503698788,966503699296,966503701227,966503701924,966503707460,966503708093,966503708496,966503709249,966503709308,966503709378,966503711647,966503711886,966503713654,966503715392,966503716858,966503717163,966503717627,966503719153,966503719627,966503720574,966503721195,966503721902,966503722314,966503725289,966503726455,966503727356,966503727783,966503728885,966503730280,966503730377,966503730902,966503731079,966503731413,966503731473,966503731575,966503733349,966503734671,966503736358,966503737790,966503738913,966503738959,966503743771,966503745166,966503746063,966503746157,966503746197,966503747270,966503747791,966503748270,966503748527,966503749653,966503749730,966503749928,966503753743,966503753894,966503753974,966503754344,966503754929,966503755317,966503755847,966503758423,966503759852,966503760673,966503761432,966503761915,966503763001,966503763212,966503763221,966503764087,966503764115,966503765063,966503766647,966503766814,966503767431,966503769309,966503771622,966503771771,966503771943,966503771945,966503772746,966503773531,966503774558,966503774605,966503774887,966503775349,966503777215,966503777657,966503779106,966503780129,966503782843,966503783070,966503785388,966503787436,966503788142,966503788173,966503790750,966503791057,966503792256,966503792369,966503793316,966503793352,966503793371,966503793466,966503793662,966503794319,966503795122,966503796805,966503797949,966503798424,966503802070,966503804756,966503804958,966503804972,966503805277,966503805747,966503806832,966503807524,966503808842,966503810100,966503811228,966503811531,966503812380,966503813771,966503815586,966503817180,966503817817,966503819636,966503821082,966503821813,966503822238,966503824571,966503827323,966503827731,966503828769,966503829630,966503829712,966503830212,966503830458,966503831612,966503832497,966503834463,966503834708,966503834776,966503834874,966503837176,966503837626,966503837989,966503838250,966503839631,966503842022,966503842154,966503846584,966503847517,966503848541,966503852677,966503852783,966503853716,966503854343,966503854344,966503854997,966503857113,966503857968,966503858275,966503858649,966503859063,966503859241,966503859674,966503860026,966503861022,966503861571,966503862497,966503863349,966503863363,966503865317,966503865369,966503867267,966503867691,966503868391,966503868503,966503868766,966503869464,966503869489,966503869779,966503871787,966503873640,966503874756,966503877525,966503877787,966503878000,966503878687,966503880011,966503881391,966503881455,966503881534,966503882468,966503882483,966503882615,966503883265,966503883275,966503883850,966503884564,966503884677,966503889615,966503892144,966503892408,966503893057,966503893196,966503895479,966503895582,966503895794,966503896862,966503896946,966503897345,966503901400,966503902339,966503902356,966503902513,966503902950,966503903252,966503904155,966503904417,966503904486,966503904899,966503905197,966503905760,966503908328,966503908454,966503908547,966503908710,966503911377,966503911857,966503912753,966503913130,966503913758,966503914763,966503919820,966503919895,966503921967,966503923214,966503923883,966503924193,966503925251,966503925975,966503926912,966503927501,966503929286,966503930284,966503930975,966503931165,966503931285,966503931714,966503932355,966503933703,966503934386,966503934587,966503935160,966503935301,966503935652,966503936503,966503938443,966503938743,966503938785,966503938840,966503940334,966503940776,966503942197,966503942552,966503943064,966503943309,966503945313,966503946559,966503946803,966503947663,966503950530,966503952160,966503952569,966503953321,966503954610,966503955005,966503956157,966503956543,966503958806,966503959345,966503959764,966503960272,966503962208,966503963927,966503964029,966503964238,966503965000,966503965545,966503965565,966503966022,966503966848,966503968455,966503968982,966503969372,966503970037,966503970244,966503970777,966503971095,966503971148,966503972545,966503976941,966503977019,966503978719,966503979033,966503980639,966503980665,966503981168,966503981499,966503981591,966503982465,966503983452,966503984066,966503985455,966503986165,966503987378,966503987716,966503988756,966503989591,966503991679,966503991894,966503991910,966503992666,966503993690,966503994793,966503995744,966503996206,966503998745,966503999095,966503999498,966503999794,966504100069,966504100756,966504101830,966504102882,966504106305,966504107152,966504108425,966504109647,966504110323,966504110381,966504111198,966504113878,966504113924,966504115030,966504117197,966504117346,966504117444,966504117563,966504118718,966504119063,966504120056,966504121733,966504121826,966504122194,966504122256,966504124065,966504124653,966504127051,966504127412,966504128471,966504128728,966504128763,966504129306,966504130316,966504130830,966504131516,966504132942,966504133640,966504134719,966504137148,966504140309,966504140631,966504142664,966504143634,966504143811,966504144009,966504145201,966504145752,966504147236,966504147622,966504147675,966504147822,966504149995,966504150298,966504152000,966504153345,966504153781,966504164950,966504164986,966504165471,966504165592,966504166059,966504170115,966504171650,966504173345,966504175360,966504176546,966504178273,966504178741,966504180251,966504180307,966504180315,966504180982,966504181136,966504182203,966504187094,966504188030,966504188496,966504188845,966504189063,966504189862,966504193403,966504195425,966504195551,966504195747,966504197572,966504197646,966504199689,966504202003,966504202301,966504203304,966504205203,966504206733,966504208276,966504211121,966504211950,966504212137,966504213195,966504213321,966504214221,966504215560,966504216648,966504219148,966504220572,966504221392,966504221546,966504222225,966504222422,966504223634,966504223839,966504223992,966504224190,966504224702,966504224715,966504225173,966504226056,966504226220,966504227391,966504227753,966504227792,966504229553,966504229957,966504230655,966504231061,966504231501,966504231800,966504235481,966504235512,966504236267,966504237042,966504237830,966504237962,966504238687,966504238830,966504240998,966504241467,966504244873,966504244982,966504245775,966504246660,966504246674,966504246815,966504250637,966504251386,966504252294,966504252814,966504253236,966504254256,966504255741,966504257118,966504257488,966504257515,966504257748,966504257773,966504259199,966504259327,966504259492,966504260475,966504261006,966504262248,966504262805,966504263108,966504263675,966504263743,966504263868,966504265494,966504266265,966504266338,966504266517,966504266873,966504269985,966504270398,966504271063,966504271644,966504274722,966504276007,966504276147,966504277118,966504277230,966504277382,966504277406,966504277848,966504278520,966504279784,966504279930,966504280208,966504280449,966504280792,966504281842,966504282137,966504282554,966504282584,966504285434,966504285725,966504287057,966504287061,966504287610,966504289149,966504289513,966504290772,966504290807,966504291421,966504292277,966504293330,966504293465,966504294432,966504296217,966504296763,966504296823,966504298188,966504298245,966504299475,966504299510,966504299712,966504299899,966504300050,966504301020,966504301482,966504301924,966504301936,966504302032,966504303199,966504303335,966504305336,966504305460,966504305469,966504306475,966504306562,966504306902,966504306923,966504307950,966504312381,966504313297,966504313875,966504314095,966504314826,966504315639,966504316181,966504317383,966504317386,966504318093,966504318968,966504319549,966504321766,966504321799,966504322565,966504323196,966504323573,966504323985,966504325513,966504325690,966504326861,966504327121,966504328865,966504328887,966504329245,966504329877,966504330080,966504330444,966504330977,966504331234,966504331784,966504333063,966504333278,966504333688,966504334753,966504334800,966504336045,966504336389,966504337657,966504337717,966504338539,966504339147,966504340133,966504340857,966504341058,966504343281,966504343972,966504345695,966504345705,966504346189,966504347336,966504347867,966504347965,966504348627,966504350336,966504350789,966504353082,966504353130,966504353262,966504355137,966504356099,966504358245,966504358543,966504359636,966504360310,966504360757,966504361707,966504361925,966504362866,966504363309,966504363455,966504363586,966504365088,966504365816,966504368083,966504369481,966504372909,966504373167,966504374075,966504375771,966504376342,966504378512,966504380790,966504381426,966504384189,966504384331,966504385554,966504385950,966504386373,966504386403,966504387947,966504388038,966504388186,966504388832,966504389069,966504389934,966504391239,966504393011,966504393204,966504393660,966504393749,966504393904,966504395306,966504395334,966504395689,966504396824,966504397497,966504397860,966504398586,966504399266,966504399652,966504399846,966504400120,966504400171,966504400283,966504404111,966504404397,966504404437,966504408605,966504409164,966504410428,966504410835,966504411134,966504411170,966504412043,966504413737,966504414560,966504415438,966504415494,966504415897,966504416470,966504416956,966504418222,966504418403,966504419107,966504419470,966504419859,966504421747,966504422621,966504422813,966504423350,966504423703,966504424160,966504424468,966504424973,966504424987,966504426716,966504427239,966504428263,966504428814,966504429305,966504429918,966504430057,966504430898,966504433438,966504433797,966504435432,966504435722,966504435850,966504436762,966504437591,966504437745,966504438701,966504438713,966504439676,966504439785,966504440406,966504440538,966504442758,966504444576,966504445573,966504446040,966504446205,966504446421,966504446705,966504448114,966504448719,966504449115,966504449280,966504449508,966504449633,966504449864,966504449956,966504450180,966504450514,966504450699,966504450793,966504451065,966504453554,966504454220,966504455155,966504455409,966504455503,966504457130,966504458229,966504458588,966504459985,966504460628,966504461051,966504464217,966504464347,966504465396,966504466679,966504467015,966504467118,966504467602,966504467708,966504467993,966504468365,966504468590,966504468802,966504468806,966504469615,966504469864,966504470071,966504470532,966504470631,966504471007,966504471379,966504471401,966504474793,966504474824,966504476616,966504477568,966504477958,966504478381,966504478884,966504478981,966504479124,966504480139,966504480736,966504483062,966504483919,966504484719,966504484846,966504485794,966504486818,966504488272,966504488415,966504488525,966504488609,966504489771,966504490042,966504491710,966504495002,966504495690,966504496697,966504497707,966504497987,966504498279,966504498508,966504499306,966504500338,966504500395,966504501022,966504503118,966504503272,966504503506,966504503553,966504504130,966504505527,966504505795,966504505944,966504507340,966504508699,966504508962,966504509268,966504509678,966504509763,966504509937,966504510746,966504511993,966504512030,966504512095,966504513131,966504513844,966504514041,966504514349,966504514706,966504515040,966504516071,966504516273,966504516556,966504517362,966504517449,966504517693,966504517815,966504517818,966504517835,966504518668,966504519169,966504519278,966504519472,966504520560,966504521026,966504521737,966504522276,966504523224,966504526126,966504526634,966504530586,966504530695,966504530815,966504533340,966504533743,966504534801,966504535768,966504536686,966504536714,966504538731,966504539066,966504539068,966504540108,966504540874,966504541408,966504542070,966504542298,966504542322,966504542860,966504544004,966504544225,966504544949,966504545856,966504547318,966504547473,966504548118,966504549898,966504550267,966504550571,966504551218,966504551979,966504553733,966504555343,966504556168,966504556684,966504557405,966504557769,966504558104,966504558316,966504558687,966504558922,966504559913,966504560110,966504560951,966504561118,966504561160,966504561777,966504562406,966504564030,966504565767,966504566377,966504566455,966504567038,966504571266,966504571523,966504575225,966504577180,966504577482,966504578591,966504579174,966504580564,966504580928,966504581142,966504581446,966504581689,966504582053,966504582817,966504583516,966504584201,966504584226,966504588062,966504588426,966504589262,966504589312,966504590085,966504590560,966504590570,966504591852,966504593912,966504594212,966504594261,966504595164,966504595464,966504595864,966504595915,966504596233,966504596643,966504597771,966504597874,966504598055,966504598735,966504601108,966504601811,966504603289,966504603423,966504605760,966504608144,966504608396,966504611371,966504611512,966504612249,966504613029,966504614707,966504615097,966504615528,966504615540,966504616294,966504616910,966504617100,966504617638,966504618028,966504618831,966504619406,966504619723,966504622200,966504624327,966504624692,966504624828,966504625962,966504626020,966504626469,966504627507,966504627707,966504629063,966504631057,966504633565,966504634502,966504635081,966504635456,966504636315,966504636383,966504636439,966504637024,966504637147,966504637503,966504639256,966504639540,966504640131,966504640150,966504640363,966504641386,966504641625,966504641989,966504642616,966504642855,966504643340,966504644354,966504644475,966504644556,966504646207,966504646531,966504647471,966504647750,966504647916,966504648531,966504649785,966504649849,966504651282,966504652188,966504652395,966504652572,966504654316,966504654485,966504655594,966504655597,966504655947,966504656124,966504658388,966504658769,966504659008,966504659524,966504662461,966504662672,966504663904,966504664866,966504665527,966504666089,966504666682,966504667312,966504667665,966504667846,966504668248,966504669215,966504669419,966504671316,966504671426,966504671946,966504674510,966504674997,966504676167,966504676848,966504677176,966504677525,966504678476,966504679388,966504680175,966504682431,966504683072,966504683824,966504685812,966504686415,966504686879,966504687056,966504687613,966504688970,966504689181,966504689339,966504690502,966504690904,966504690973,966504692678,966504693373,966504693859,966504693996,966504694443,966504694842,966504695382,966504695427,966504695994,966504696101,966504696613,966504700021,966504700287,966504700885,966504702202,966504702391,966504703341,966504703376,966504703534,966504705153,966504705665,966504707268,966504708714,966504708856,966504708954,966504709149,966504711663,966504713243,966504714007,966504714140,966504714152,966504715559,966504715734,966504716362,966504716625,966504717202,966504717750,966504718190,966504718375,966504719323,966504720908,966504721488,966504721512,966504722293,966504723699,966504724389,966504726378,966504727292,966504728064,966504728759,966504730800,966504731073,966504731215,966504731693,966504732644,966504732728,966504732802,966504732822,966504733244,966504734599,966504783285,966504791380,966504808390,966504834129,966504860972,966504874126,966504923740,966504933586,966504937970,966504961059,966504973172,966504974329,966505103475,966505104870,966505114968,966505118349,966505124058,966505125551,966505128207,966505135172,966505137898,966505140041,966505141516,966505148308,966505151663,966505152866,966505153582,966505154053,966505155899,966505159743,966505160167,966505161017,966505163997,966505165086,966505168220,966505168625,966505168856,966505171542,966505172093,966505172682,966505173957,966505174515,966505174954,966505177745,966505181076,966505184448,966505185164,966505185175,966505188247,966505188979,966505189215,966505192859,966505193119,966505194534,966505199618,966505201443,966505204225,966505205444,966505209464,966505211679,966505212252,966505212428,966505213034,966505213840,966505216208,966505218583,966505221078,966505223240,966505225024,966505226523,966505228297,966505228756,966505230456,966505230598,966505230911,966505231079,966505232104,966505233869,966505235913,966505235975,966505239678,966505243664,966505245221,966505247566,966505247855,966505248043,966505252827,966505253116,966505253118,966505256845,966505257039,966505259855,966505260380,966505260688,966505260888,966505262005,966505264361,966505264673,966505265994,966505269276,966505271562,966505276432,966505276804,966505278622,966505280041,966505280717,966505281708,966505282001,966505288073,966505288157,966505289217,966505290054,966505293446,966505295080,966505295587,966505296866,966505297477,966505298322,966505298911,966505299395,966505300242,966505303379,966505303805,966505303839,966505306217,966505306234,966505307456,966505311334,966505311561,966505312533,966505368957,966505372837,966505390849,966505529747,966505566467,966505650580,966505709108,966505720423,966505925245,966505991766,966506001839,966506068954,966506077196,966506079474,966506083878,966506162172,966506178211,966506328853,966506331593,966506347870,966506451003,966506466214,966506565495,966506634181,966506636661,966506637731,966506675220,966506688641,966506693105,966506698784,966506704085,966506710477,966506797456,966506829775,966506963006,966506971154,966506989554,966507011898,966507015341,966507060476,966507074958,966507120237,966507138294,966507169531,966507185564,966507190416,966507192030,966507207199,966507234189,966507251527,966507267394,966507267401,966507276125,966507281676,966507310623,966507327345,966507330175,966507369114,966507371942,966507376180,966507417538,966507420935,966507460755,966507471386,966507529079,966507536533,966507544708,966507564800,966507574033,966507576562,966507607916,966507609323,966507643186,966507721994,966507722923,966507723697,966507745799,966507746693,966507746766,966507814163,966507837001,966507868760,966507883801,966507885072,966507921566,966507929117,966507989493,966507991196,966508041329,966508110454,966508227416,966508270225,966508282655,966508373236,966508393904,966508428634,966508428725,966508461503,966508528810,966508537942,966508555991,966508590711,966508647915,966508671058,966508691942,966508712916,966508772696,966508780090,966508782296,966508784751,966508801399,966508801993,966508817962,966508819940,966508836331,966508902361,966508961582,966508975052,966508977760,966509031036,966509081518,966509093026,966509216497,966509223044,966509225980,966509261430,966509277494,966509278357,966509310727,966509328061,966509360639,966509376656,966509433128,966509472720,966509497713,966509526729,966509545277,966509556212,966509582349,966509588679,966509608992,966509652985,966509672561,966509685843,966509825908,966509835559,966509845090,966509852164,966509937997,966509941721,966530040970,966530041770,966530068312,966530090115,966530112330,966530119153,966530176669,966530190112,966530201863,966530228633,966530230662,966530277145,966530311755,966530441267,966530584104,966530584291,966530587086,966530640920,966530701654,966530844405,966530862849,966530893870,966530931808,966530970418,966530976546,966530993915,966530999757,966531008911,966531016504,966531051927,966531133820,966531172230,966531211295,966531236514,966531254011,966531258210,966531287060,966531300292,966531315754,966531323658,966531340418,966531340732,966531356956,966531372863,966531399647,966531437482,966531488991,966531492170,966531493810,966531560804,966531581463,966531588578,966531589601,966531608142,966531612572,966531615090,966531642541,966531647937,966531648374,966531650362,966531820092,966531824580,966531874775,966531886504,966531904793,966531907184,966531915323,966532064664,966532099105,966532106852,966532121882,966532134456,966532143431,966532150552,966532180144,966532184181,966532221521,966532231020,966532267880,966532319776,966532320814,966532337181,966532373717,966532378368,966532401153,966532420747,966532482613,966532526189,966532623482,966532623736,966532661165,966532818663,966532824952,966532830550,966532873877,966532910547,966532921622,966532928825,966532979680,966532991108,966533011469,966533012015,966533018752,966533020951,966533116556,966533136717,966533160832,966533202690,966533212215,966533215540,966533219022,966533224917,966533229789,966533283964,966533302337,966533320480,966533486302,966533491503,966533576428,966533587299,966533623989,966533683628,966533696459,966533731298,966533751907,966533758026,966533758406,966533869686,966533871442,966533871471,966533873165,966533884121,966533894635,966533898767,966534003177,966534022096,966534154045,966534173486,966534203143,966534206735,966534223108,966534235142,966534243055,966534244842,966534284388,966534355787,966534375668,966534424976,966534447334,966534497050,966534594584,966534597088,966534748485,966534783002,966534820379,966534850995,966534927216,966534936487,966534938249,966534973296,966534980324,966534990065,966535016137,966535035734,966535044710,966535064399,966535078090,966535091340,966535148445,966535219029,966535226166,966535273225,966535276298,966535328470,966535332518,966535354955,966535358715,966535406643,966535431700,966535433016,966535453961,966535462176,966535484181,966535523569,966535524096,966535545009,966535546841,966535563694,966535564068,966535572383,966535579747,966535600467,966535609859,966535611705,966535634396,966535697273,966535719184,966535811330,966535826591,966535871797,966535881096,966535947379,966536035998,966536039560,966536087829,966536108915,966536113005,966536122557,966536124291,966536141232,966536152530,966536159582,966536172983,966536180759,966536188259,966536226169,966536234552,966536235218,966536236594,966536289163,966536308098,966536324441,966536325462,966536333963,966536361612,966536391630,966536397725,966536401091,966536425074,966536425928,966536451615,966536462005,966536466068,966536470957,966536490238,966536494243,966536504155,966536560405,966536566988,966536569147,966536570889,966536572355,966536574310,966536586226,966536589709,966536623068,966536640795,966536641695,966536661225,966536676437,966536687527,966536688237,966536706473,966536756419,966536762339,966536802625,966536831373,966536850174,966536879410,966536896126,966536918976,966536942833,966536949534,966536952431,966536958839,966536989118,966537004529,966537005528,966537033697,966537043061,966537046646,966537050214,966537056002,966537099890,966537136654,966537147090,966537167154,966537237558,966537279060,966537296345,966537337248,966537344758,966537376707,966537379205,966537386978,966537410367,966537412989,966537413334,966537438713,966537451904,966537460034,966537474944,966537503548,966537518084,966537529287,966537572748,966537609362,966537623178,966537645572,966537649678,966537671982,966537701694,966537719220,966537722425,966537745134,966537785889,966537802080,966537804237,966537842754,966537856440,966537881216,966537883221,966537887686,966537896820,966537902658,966537945436,966537960633,966537963115,966537977283,966537989315,966538002559,966538005769,966538008068,966538013751,966538030781,966538037434,966538043968,966538054184,966538056050,966538071992,966538090732,966538092637,966538103351,966538118854,966538127306,966538127851,966538134566,966538134749,966538162855,966538172339,966538196365,966538205982,966538219629,966538229556,966538229632,966538230036,966538231732,966538237071,966538283776,966538299867,966538304362,966538310436,966538313562,966538339549,966538349180,966538355771,966538366522,966538388117,966538399762,966538405995,966538411898,966538414075,966538421034,966538424515,966538439463,966538440695,966538442241,966538482348,966538489437,966538492699,966538497005,966538510701,966538525049,966538530420,966538530920,966538531218,966538532490,966538535786,966538541819,966538569374,966538575103,966538585994,966538604997,966538613588,966538617814,966538650982,966538674868,966538691591,966538708909,966538716805,966538735841,966538745327,966538760469,966538771270,966538792293,966538795005,966538796353,966538820992,966538869209,966538890263,966538902545,966538930938,966538940964,966538943483,966538944266,966538957867,966538972028,966545352837,966550073712,966550076270,966550083592,966550086228,966550112521,966550122872,966550124273,966550133658,966550140977,966550141849,966550148793,966550167369,966550171435,966550182373,966550195986,966550210385,966550217119,966550225309,966550245375,966550299763,966550314537,966550355532,966550356750,966550384954,966550401959,966550402334,966550403800,966550404282,966550404424,966550421285,966550439200,966550456636,966550461720,966550464776,966550469366,966550588138,966550591796,966550612774,966550682784,966550695525,966550704813,966550712744,966550727530,966550751157,966550755390,966550759252,966550767057,966550768819,966550782012,966550792846,966550801852,966550817705,966550823625,966550827604,966550836454,966550845581,966550916697,966550925822,966550926003,966550938830,966550988266,966551008912,966551029248,966551097870,966551112286,966551116744,966551129357,966551184092,966551265516,966551277971,966551289422,966551296979,966551306907,966551310276,966551310513,966551353985,966551368743,966551388241,966551398465,966551414701,966551484980,966551494881,966551511148,966551528709,966551545710,966551547877,966551560748,966551592363,966551638164,966551650253,966551674505,966551708022,966551725315,966551725555,966551731978,966551757317,966551769033,966551775941,966551776645,966551788166,966551805313,966551807782,966551817382,966551837230,966551841077,966551866406,966551891541,966551930067,966551954134,966551974883,966552023715,966552028567,966552046488,966552053467,966552064682,966552070403,966552074042,966552099323,966552124846,966552183197,966552208057,966552224673,966552251140,966552271547,966552275605,966552312082,966552315383,966552321205,966552348676,966552352474,966552382807,966552409472,966552414126,966552426773,966552461657,966552474287,966552492611,966552496683,966552538359,966552565456,966552567932,966552569250,966552591222,966552615991,966552696390,966552723096,966552763453,966552788761,966552792421,966552806405,966552836532,966552872896,966552915435,966553057704,966553063521,966553070940,966553078356,966553097147,966553120460,966553123488,966553135756,966553137648,966553193691,966553265344,966553368106,966553426738,966553449052,966553465269,966553480649,966553523383,966553533174,966553542640,966553566128,966553607164,966553642528,966553648471,966553732799,966553749769,966553842391,966553850132,966553856334,966553876242,966553884950,966553889044,966553921589,966553941950,966553961629,966554028940,966554035268,966554061397,966554106990,966554107538,966554131500,966554138050,966554160068,966554167564,966554173144,966554298494,966554334907,966554350366,966554353817,966554373670,966554407051,966554415201,966554421639,966554435021,966554451927,966554485715,966554509821,966554529415,966554560524,966554564219,966554564764,966554598916,966554624277,966554635506,966554639128,966554710287,966554727951,966554767112,966554790086,966554804718,966554826928,966554841136,966554858886,966554865885,966554870558,966554897112,966554926386,966554990750,966555097236,966555123057,966555271973,966555523997,966555668172,966555679583,966555713280,966555775154,966555799314,966555816850,966555891518,966555961340,966555965717,966555967216,966555988395,966555998643,966556002975,966556051755,966556075059,966556102438,966556124485,966556133468,966556152146,966556169846,966556196828,966556295184,966556308968,966556328674,966556338831,966556348821,966556368142,966556373229,966556374807,966556374988,966556382219,966556451161,966556500554,966556503364,966556515412,966556516876,966556546046,966556551337,966556596089,966556616902,966556618444,966556629340,966556654182,966556740628,966556767348,966556781578,966556791697,966556793013,966556794084,966556809169,966556947645,966556948782,966556952057,966556954273,966556961683,966556964017,966556967585,966556980939,966556989154,966556993021,966557028772,966557030440,966557049603,966557056746,966557068049,966557077961,966557079350,966557088460,966557142410,966557222517,966557248373,966557254882,966557262226,966557273062,966557288411,966557302686,966557306612,966557308145,966557310764,966557313841,966557357115,966557411457,966557417446,966557421399,966557428262,966557459950,966557478454,966557501869,966557621314,966557627190,966557633436,966557633813,966557639742,966557670898,966557695768,966557719122,966557726742,966557727457,966557730721,966557745255,966557836760,966557845775,966557878663,966557906141,966557960558,966557998400,966558045924,966558066430,966558125722,966558127529,966558127535,966558190245,966558192133,966558230510,966558244705,966558252787,966558280597,966558307406,966558325210,966558398366,966558414047,966558439844,966558503788,966558573435,966558631184,966558633170,966558642127,966558677694,966558762838,966558781544,966558827172,966558848918,966558852922,966558897180,966558902196,966558908447,966558912347,966558914355,966558939644,966558943407,966558947157,966558984868,966558999983,966559003035,966559031855,966559063764,966559121562,966559139240,966559150318,966559196470,966559216653,966559257876,966559322259,966559362184,966559363695,966559384898,966559424571,966559436946,966559457682,966559469869,966559500202,966559525199,966559531132,966559608131,966559666269,966559706055,966559717624,966559728448,966559738732,966559781723,966559785054,966559791706,966559800117,966559807438,966559830380,966559844773,966559864415,966559875800,966559962344,966559969019,966561355242,966777000123,966777000124]),
}


def get_group_of_msisdn(line):
    global groups
    msisdn=helper_regex.extract(line,r'no=(\d+)')
    if not msisdn:
        return ''
    msisdn=int(msisdn)
    for k,g in groups.iteritems():
        if msisdn in g:
            return k
    return ''
    
def stat_website(my_date):

    global groups

    sql=r'''

    select 
    LEFT(CONVERT(VARCHAR, createdon, 120), 13) as created_time
    ,count(distinct msisdn) as msisdn_count
    from shabik_mt.dbo.stc_broadcast_round_2011_12_22 
    where createdon>='2012-02-13 00:00:00'
    group by LEFT(CONVERT(VARCHAR, createdon, 120), 13)
    having count(distinct msisdn)>=100
    order by LEFT(CONVERT(VARCHAR, createdon, 120), 13)

    '''

    time_table=helper_sql_server.fetch_dict(config.conn_mt,sql)

    for t in time_table.keys():

        sql=r'''

        select 
        distinct replace(msisdn,'+','')
        from shabik_mt.dbo.stc_broadcast_round_2011_12_22 
        where LEFT(CONVERT(VARCHAR, createdon, 120), 13)='%s'

        ''' % (t,)

        msisdn_set=helper_sql_server.fetch_set(config.conn_mt,sql)
        msisdn_set=set([int(i) for i in msisdn_set])
        
        groups[t.replace('-','_').replace(' ','_')]=msisdn_set
        print t,len(msisdn_set)



    current_date=datetime.fromtimestamp(my_date).strftime('%Y-%m-%d')
    get_current_date=lambda line:current_date

    #2011-08-13 16:02:12 GET /360/stc.jar - 84.235.75.80 HTTP/1.1 Nokia7230/5.0+(06.90)+Profile/MIDP-2.1+Configuration/CLDC-1.1 - 200 517172 34003

    oem_name='Shabik_360'
    stat_category='project_sms_broadcast'
    
    db_name='raw_data_device_shabik_360'

    #collect device-client matching rules
    #2011-04-18 10:00:10 GET /download/ve.jar - 41.206.130.5 HTTP/1.1 Nokia7610/2.0+(7.0642.0)+SymbianOS/7.0s+Series60/2.1+Profile/MIDP-2.0+Configuration/CLDC-1.0 - - 304 213 296
    
    #request by downloader
  	#2011-09-07 07:49:18 GET /download-gateway.aspx - 115.66.172.127 HTTP/1.1 s605th/shabik360/353391046226409 - - 200 328 218
  	#2011-09-07 07:49:18 GET /download-gateway.aspx - 115.66.172.127 HTTP/1.1 s603rd/shabik360/353391046226409 - - 200 328 218


    # msisdn accessed download page

    stat_plan=Stat_plan()
    
    stat_sql_download_user_daily=Stat_sql(oem_name=oem_name,stat_category=stat_category, \
                                        select_count_distinct_collection={'msisdn':r'no=(\d+)'},\
                                        where={'filtered':r'(n)o=\d+'}, \
                                        group_by={'daily':get_current_date, \
                                                  'by_group':get_group_of_msisdn},
                                        db_name=db_name)
    
    stat_plan.add_stat_sql(stat_sql_download_user_daily)

    start_time=1329037562

    for t in range(start_time,int(my_date+3600*24),3600*24):

        stat_plan.add_log_source(r'\\192.168.0.175\w3svc581074064\ex' \
               +datetime.fromtimestamp(t).strftime('%y%m%d') \
               +'.log')


    stat_plan.dump_sources()

    stat_plan.run()    
    

    # msisdn accessed download page and redirected

    stat_plan=Stat_plan()
    
    stat_sql_download_user_daily=Stat_sql(oem_name=oem_name,stat_category=stat_category, \
                                        select_count_distinct_collection={'msisdn':r'no=(\d+)'},\
                                        where={'filtered_directed':r'(n)o=\d+'}, \
                                        group_by={'daily':get_current_date, \
                                                  'by_group':get_group_of_msisdn},
                                        db_name=db_name)
    
    stat_plan.add_stat_sql(stat_sql_download_user_daily)

    start_time=1329037562

    for t in range(start_time,int(my_date+3600*24),3600*24):
        """
        stat_plan.add_log_source(r'\\192.168.0.175\w3svc581074064\ex' \
               +datetime.fromtimestamp(t).strftime('%y%m%d') \
               +'.log')
        """
        stat_plan.add_url_sources(helper_regex.translate_iis_website_hourly_log_path(
                                        t,r'http://212.100.219.210/W3SVC1160380090/ex%(date)s%(hour)s.log', \
                                        timezone_offset_to_sg=config.timezone_offset_shabik_360+8,date_format='%y%m%d'))


    stat_plan.dump_sources()

    stat_plan.run()    
    

    
    for k,g in groups.iteritems():
        
        # save original group

        key='original_msisdn_unique'
        helper_mysql.put_raw_data(oem_name,stat_category,key,k,len(g),db_name,current_date)

        # not accessing download site
        
        download_collection=helper_mysql.get_raw_collection_from_key(oem_name='Shabik_360',category='project_sms_broadcast', \
                                                                     key='filtered_by_group_daily_msisdn_unique',sub_key=k, \
                                                                     date=current_date,table_name='raw_data_device_shabik_360')
        g=set([str(i) for i in g])
        non_download_collection=g-download_collection

        key='non_download_msisdn_unique'
        helper_mysql.put_collection(collection=non_download_collection,oem_name=oem_name,category=stat_category, \
                                    key=key,sub_key=k,table_name=db_name,date=current_date,created_on=None)
        
        

        # check moagent active

        begin_date='2012-02-13'
        end_date=helper_regex.get_date_str_now()
        
        logined_msisdn_set=common_shabik_360.filter_moagent_active(download_collection,begin_date,end_date)
        non_logined_msisdn_set=download_collection-logined_msisdn_set

        key='logined_msisdn_unique'
        helper_mysql.put_collection(collection=logined_msisdn_set,oem_name=oem_name,category=stat_category, \
                                    key=key,sub_key=k,table_name=db_name,date=current_date,created_on=None)

        key='non_logined_msisdn_unique'
        helper_mysql.put_collection(collection=non_logined_msisdn_set,oem_name=oem_name,category=stat_category, \
                                    key=key,sub_key=k,table_name=db_name,date=current_date,created_on=None)
        
        
        
        total_logined_msisdn_set=common_shabik_360.filter_moagent_active(g,begin_date,end_date)

        key='total_logined_msisdn_unique'
        helper_mysql.put_collection(collection=total_logined_msisdn_set,oem_name=oem_name,category=stat_category, \
                                    key=key,sub_key=k,table_name=db_name,date=current_date,created_on=None)

if __name__=='__main__':

    for i in range(config.day_to_update_stat,0,-1):
        my_date=time.time()-3600*24*i
        stat_website(my_date)
